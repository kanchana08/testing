
pipeline {
    
    agent any

    stages {
        stage(checkout) {
            steps {
                git branch: 'main', credentialsId: 'GIT_PATH', url: 'https://github.com/kanchana08/testing.git'
            }
        }
        
        stage('Hello') {
            steps {
                script {
                    // Checking and creating screen sessions if they do not exist
                    sh '''
                        if ! screen -list | grep -q 'my_screen_session'; then 
                            screen -dmS my_screen_session
                        fi
                        
                        if ! screen -list | grep -q 'my_screen_session2'; then 
                            screen -dmS my_screen_session2
                        fi
                    '''
                    
                    // Terminate any running processes in the screen sessions
                    sh "screen -S my_screen_session -X stuff '^c'"
                    sh "screen -S my_screen_session2 -X stuff '^C'"
                    
                    // Start the Python scripts in the screen sessions
                    sh "screen -S my_screen_session -X stuff 'python3 hello.py\\n'"
                    sh "screen -S my_screen_session2 -X stuff 'python3 hlo.py\\n'"
                    
                    // List all screen sessions
                    sh 'screen -ls'
                }
            }
        }
    }
}
